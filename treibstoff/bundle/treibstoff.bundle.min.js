var ts=function(t,e){"use strict";function s(t,e,s){console.log(`DEPRECATED: ${t} is deprecated and will be removed as of ${s}. Use ${e} instead.`)}function i(){return([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,(t=>(t^crypto.getRandomValues(new Uint8Array(1))[0]&15>>t/4).toString(16)))}function a(t,e,s){return void 0===t[e]&&(t[e]=s),t[e]}function n(t,e){return t.charAt(t.length-1)===e&&(t=t.substring(0,t.length-1)),t}function r(t){let e=document.createElement("a");e.href=t;let s=e.pathname;return n(t=e.protocol+"//"+e.host+s,"/")}function o(t,e){let s=document.createElement("a");s.href=t;let i=s.search;if(e)return i||"";let a={};if(i){let t=i.substring(1,i.length).split("&");for(let e=0;e<t.length;e++){let s=t[e].split("=");a[s[0]]=s[1]}}return a}function h(t,e){let s=document.createElement("a");s.href=t;let i=n(s.pathname,"/");return e&&(i+=o(t,!0)),i}const l="http://www.w3.org/2000/svg";function c(t,e){for(let s in e)t.setAttributeNS(null,s,e[s])}function d(t,e,s){let i=document.createElementNS(l,t);return c(i,e),void 0!==s&&s.appendChild(i),i}function u(t,e){var s=d("svg",{});s.innerHTML=t.trim();let i=[],a=s.childNodes;for(let t=0;t<a.length;t++){let n=a[t];i.push(n),s.removeChild(n),void 0!==e&&e.appendChild(n)}return i}class p{constructor(t,e,s){this._inst=t,this._name=e,this._val=null,Object.defineProperty(t,e,{get:this.get.bind(this),set:this.set.bind(this),enumerable:!0}),void 0!==s&&(t[e]=s)}get(){return this._val}set(t){let e=t!==this._val;this._val=t,e&&this.trigger(`on_${this._name}`,t)}trigger(t,e){let s=this._inst;s.trigger&&s.trigger(t,e)}}class _ extends p{constructor(t,e,s){super(t,e),this._ctxa="elem",s?(this._ctxa=void 0!==s.ctxa?s.ctxa:this._ctxa,this._ctx=void 0!==s.ctx?s.ctx:t[this._ctxa],this._tgt=void 0!==s.tgt?s.tgt:e):(this._ctx=t[this._ctxa],this._tgt=e);let i=s?s.val:void 0;void 0!==i&&(t[e]=i)}get name(){return this._name}get val(){return this._val}get ctx(){return this._ctx||(this._ctx=this._inst[this._ctxa]),this._ctx}get tgt(){return this._tgt}}class m extends _{set(t){e(this.ctx).css(this.tgt,t),super.set(t)}}class g extends _{constructor(t,e,s){super(t,e,s),this.extract=s?s.extract:null,this.state_evt=s&&s.state_evt?s.state_evt:"on_prop_state",this.error=!1,this.msg="",this._err_marker={},this.ctx.on("change",this._change.bind(this))}set(t){e(this.ctx).val(t),this._set(t)}_change(t){let s=e(t.currentTarget).val();this._set(s)}_set(t){(t=this._extract(t))!==this._err_marker&&super.set(t),this.extract&&this.trigger(this.state_evt,this)}_extract(t){if(this.extract)try{t=this.extract(t),this.error=!1,this.msg=""}catch(e){t=this._err_marker,this.error=!0,this.msg=e}return t}}class f extends _{constructor(t,e,s){super(t,e,s),this.ctx.on("mousedown",this._down.bind(this)),this.ctx.on("mouseup",this._up.bind(this)),this.ctx.on("click",this._click.bind(this))}set(t){this.ctx.text(t),super.set(t)}_down(t){this.trigger(`on_${this.name}_down`,this)}_up(t){this.trigger(`on_${this.name}_up`,this)}_click(t){this.trigger(`on_${this.name}_click`,this)}}class x{walk(t){let e=t.childNodes;for(let t of e)this.walk(t);t.nodeType===Node.ELEMENT_NODE&&this.parse(t)}parse(t){}node_attrs(t){let e={};for(let s of t.attributes)s&&s.nodeName&&(e[s.nodeName]=s.nodeValue);return e}}class v extends x{constructor(t){super(),this.widget=t,this.handlers={}}parse(t){let e=this.node_attrs(t),s=this.wrap_node(t);this.handle_elem_attr(s,e);let i=t.tagName.toLowerCase(),a=this.handlers[i];a&&a(s,e)}wrap_node(t){return t}handle_elem_attr(t,e){let s=e["t-elem"];s&&(this.widget[s]=t)}}function w(t){if(isNaN(t))throw"Input is not a number";return Number(t)}class y extends v{constructor(t){super(t),this.handlers={input:this.handle_input.bind(this),select:this.handle_select.bind(this),button:this.handle_button.bind(this)},this.extractors={number:w}}wrap_node(t){return e(t)}handle_input(t,e){let s=e["t-prop"];if(!s)return;let i=this.widget,a=this.extractors[e["t-type"]];e["t-extract"]&&(a=i[e["t-extract"]]);let n=e["t-val"];a&&(n=a(n)),new g(i,s,{ctx:t,ctxa:e["t-elem"],val:n,extract:a,state_evt:e["t-state-evt"]})}handle_select(t,e){let s=e["t-options"];if(s)for(let e of JSON.parse(s))t.append(`<option value="${e[0]}">${e[1]}</option>`);this.handle_input(t,e)}handle_button(t,e){let s=e["t-prop"];if(!s)return;let i=this.widget;new f(i,s,{ctx:t,ctxa:e["t-elem"],val:e["t-val"]});for(let t of["down","up","click"])if(e[`t-bind-${t}`]){let a=i[e[`t-bind-${t}`]].bind(i);this.widget.on(`on_${s}_${t}`,a)}}}function b(t,s,i){let a=e(s.trim());i&&i.append(a);let n=new y(t);return a.each((function(){n.walk(this)})),a}class j extends v{}class k{constructor(){this._subscribers={},this._suppress_events=!1}on(t,e){let s=this._subscribers[t];return void 0===s&&(this._subscribers[t]=s=new Array),this._contains_subscriber(t,e)||s.push(e),this}off(t,e){let s=this._subscribers[t];if(void 0===s)return this;if(!e)return delete this._subscribers[t],this;let i=s.indexOf(e);return i>-1&&(s=s.splice(i,1)),this._subscribers[t]=s,this}trigger(t,e){if(this._suppress_events)return;this[t]&&this[t](e);let s=this._subscribers[t];if(!s)return this;for(let t=0;t<s.length;t++)s[t](this,e);return this}suppress_events(t){this._suppress_events=!0,t(),this._suppress_events=!1}bind_from_options(t,e){for(let s of t)e[s]&&this.on(s,e[s])}_contains_subscriber(t,e){let s=this._subscribers[t];if(!s)return!1;for(let t=0;t<s.length;t++)if(s[t]===e)return!0;return!1}}class A extends k{constructor(t){super(),this.uid=t.uid?t.uid:i(),this.css=t.css?t.css:"",this.title=t.title?t.title:"&nbsp;",this.content=t.content?t.content:"",this.bind_from_options(["on_open","on_close"],t),this.container=t.container?t.container:e("body"),this.compile(),this.elem.data("overlay",this),this.is_open=!1}compile(){b(this,`\n          <div class="modal ${this.css}" id="${this.uid}" t-elem="elem">\n            <div class="modal-dialog">\n              <div class="modal-content">\n                <div class="modal-header">\n                  <button class="close" t-prop="close_btn" t-bind-click="close">\n                    <span aria-hidden="true">&times;</span>\n                    <span class="sr-only">Close</span>\n                  </button>\n                  <h5 class="modal-title">${this.title}</h5>\n                </div>\n                <div class="modal-body" t-elem="body">${this.content}</div>\n                <div class="modal-footer" t-elem="footer"></div>\n              </div>\n            </div>\n          </div>\n        `)}open(){e("body").css("padding-right","13px").css("overflow-x","hidden").addClass("modal-open"),this.container.append(this.elem),this.elem.show(),this.is_open=!0,this.trigger("on_open")}close(){1===e(".modal:visible").length&&e("body").css("padding-right","").css("overflow-x","auto").removeClass("modal-open"),this.elem.remove(),this.is_open=!1,this.trigger("on_close")}}function $(t){let s=e(`#${t}`);if(!s.length)return null;let i=s.data("overlay");return i||null}class q extends A{constructor(t){t.content=t.message?t.message:t.content,t.css=t.flavor?t.flavor:t.css,super(t),this.compile_actions()}compile_actions(){b(this,'\n          <button class="close btn btn-default allowMultiSubmit"\n                  t-prop="f_close_btn" t-bind-click="close">Close</button>\n        ',this.footer)}}function P(t){new q({title:t.title,message:t.message,flavor:t.flavor,on_open:function(t){e("button",t.elem).first().focus()}}).open()}function E(t){P({title:"Info",message:t,flavor:"info"})}function S(t){P({title:"Warning",message:t,flavor:"warning"})}function C(t){P({title:"Error",message:t,flavor:"error"})}class O extends q{constructor(t){a(t,"css","dialog"),super(t),this.bind_from_options(["on_confirm"],t)}compile_actions(){b(this,'\n          <button class="ok btn btn-default allowMultiSubmit"\n                  t-prop="ok_btn">OK</button>\n          <button class="cancel btn btn-default allowMultiSubmit"\n                  t-prop="cancel_btn" t-bind-click="close">Cancel</button>\n        ',this.footer)}on_ok_btn_click(){this.close(),this.trigger("on_confirm")}}function N(t){new O({title:t.title,message:t.message,on_confirm:t.on_confirm}).open()}class T{constructor(){this._request_count=0,this.icon_source="/treibstoff-static/loading-spokes.svg",this.compile()}compile(){b(this,`\n          <div id="ajax-spinner" t-elem="elem">\n            <img src="${this.icon_source}" width="64" height="64" alt="" />\n          </div>\n        `)}show(){this._request_count++,this._request_count>1||e("body").append(this.elem)}hide(t){if(this._request_count--,t)return this._request_count=0,void this.elem.remove();this._request_count<=0&&(this._request_count=0,this.elem.remove())}}class M{constructor(t){this.spinner=t.spinner,a(t,"win",window),this.win=t.win,a(t,"default_403","/login"),this.default_403=t.default_403}execute(t){if(-1!==t.url.indexOf("?")){let e=t.params;t.params=o(t.url),t.url=r(t.url);for(let s in e)t.params[s]=e[s]}else a(t,"params",{});a(t,"type","html"),a(t,"method","GET"),a(t,"cache",!1),a(t,"error",function(t,e,s){if(403===parseInt(e,10))return this.win.location.hash="",void(this.win.location.pathname=this.default_403);C(`<strong>${e}</strong>${s}`)}.bind(this));let s=function(e,s,i){t.success(e,s,i),this.spinner.hide()}.bind(this),i=function(e,s,i){0!==e.status?(s=e.status||s,i=e.statusText||i,t.error(e,s,i),this.spinner.hide(!0)):this.spinner.hide(!0)}.bind(this);this.spinner.show(),e.ajax({url:t.url,dataType:t.type,data:t.params,method:t.method,success:s,error:i,cache:t.cache})}}class D extends k{parse_target(t){return{url:t?r(t):void 0,params:t?o(t):{},path:t?h(t):void 0,query:t?o(t,!0):void 0}}parse_definition(t){return t.replace(/\s+/g," ").split(" ")}action_target(t,e){return e.ajaxtarget?e.ajaxtarget:this.parse_target(t.attr("ajax:target"))}}class L extends D{constructor(t){super(),this.event=t.event,this.dispatcher=t.dispatcher,this.dispatcher.on(this.event,this.handle.bind(this))}execute(t){throw"Abstract AjaxOperation does not implement execute"}handle(t,e){throw"Abstract AjaxOperation does not implement handle"}}class G extends L{constructor(t){t.event="on_path",super(t),this.win=t.win,e(this.win).on("popstate",this.state_handle.bind(this))}execute(t){let e=this.win.history;if(void 0===e.pushState)return;let s="/"!==t.path.charAt(0)?`/${t.path}`:t.path;a(t,"target",this.win.location.origin+s),a(t,"replace",!1);let i=t.replace;delete t.path,delete t.replace,t._t_ajax=!0,i?e.replaceState(t,"",s):e.pushState(t,"",s)}state_handle(t){let e,s=t.originalEvent.state;s&&s._t_ajax&&(t.preventDefault(),e=s.target.url?s.target:this.parse_target(s.target),e.params.popstate="1",s.action&&this.dispatcher.trigger("on_action",{target:e,action:s.action}),s.event&&this.dispatcher.trigger("on_event",{target:e,event:s.event}),s.overlay&&this.dispatcher.trigger("on_overlay",{target:e,overlay:s.overlay,css:s.overlay_css,uid:s.overlay_uid,title:s.overlay_title}),s.action||s.event||s.overlay||(this.win.location=e.url))}handle(t,e){let s,i=e.elem,a=e.event,n=i.attr("ajax:path");if("href"===n){n=h(i.attr("href"),!0)}else if("target"===n){let t=this.action_target(i,a);n=t.path+t.query}if(this.has_attr(i,"ajax:path-target")){let t=i.attr("ajax:path-target");t&&(s=this.parse_target(t))}else s=this.action_target(i,a);let r={path:n,target:s};r.action=this.attr_val(i,"ajax:path-action","ajax:action"),r.event=this.attr_val(i,"ajax:path-event","ajax:event"),r.overlay=this.attr_val(i,"ajax:path-overlay","ajax:overlay"),r.overlay&&(r.overlay_css=this.attr_val(i,"ajax:path-overlay-css","ajax:overlay-css"),r.overlay_uid=this.attr_val(i,"ajax:path-overlay-uid","ajax:overlay-uid"),r.overlay_title=this.attr_val(i,"ajax:path-overlay-title","ajax:overlay-title")),this.execute(r)}has_attr(t,e){let s=t.attr(e);return void 0!==s&&!1!==s}attr_val(t,e,s){return this.has_attr(t,e)?t.attr(e):t.attr(s)}}class V extends L{constructor(t){a(t,"event","on_action"),super(t),this.spinner=t.spinner,this._handle=t.handle,this._request=t.request}execute(t){t.success=this.complete.bind(this),this.request(t)}request(t){t.params["ajax.action"]=t.name,t.params["ajax.mode"]=t.mode,t.params["ajax.selector"]=t.selector,this._request.execute({url:r(t.url)+"/ajaxaction",type:"json",params:t.params,success:t.success})}complete(t){t?(this._handle.update(t),this._handle.next(t.continuation)):(C("Empty Response"),this.spinner.hide())}handle(t,e){let s=e.target,i=e.action;for(let t of this.parse_definition(i)){let e=t.split(":");this.execute({name:e[0],selector:e[1],mode:e[2],url:s.url,params:s.params})}}}class H extends L{constructor(t){t.event="on_event",super(t)}execute(t){let s=this.create_event.bind(this);e(t.selector).each((function(){e(this).trigger(s(t.name,t.target,t.data))}))}create_event(t,s,i){let a=e.Event(t);return s.url?a.ajaxtarget=s:a.ajaxtarget=this.parse_target(s),a.ajaxdata=i,a}handle(t,e){let s=e.target,i=e.event;for(let t of this.parse_definition(i)){let e=t.split(":");this.execute({name:e[0],selector:e[1],target:s})}}}class I extends V{constructor(t){t.event="on_overlay",super(t),this.overlay_content_sel=".modal-body"}execute(t){let e,s,a;if(t.close)return e=$(t.uid),e&&e.close(),e;if(t.target){let e=t.target;e.url||(e=this.parse_target(e)),s=e.url,a=e.params}else s=t.url,a=t.params;let n=t.uid?t.uid:i();return a["ajax.overlay-uid"]=n,e=new A({uid:n,css:t.css,title:t.title,on_close:t.on_close}),this.request({name:t.action,selector:`#${n} ${this.overlay_content_sel}`,mode:"inner",url:s,params:a,success:function(t){t.payload?(e.open(),this.complete(t)):this.complete(t)}.bind(this)}),e}handle(t,e){let s=e.target,i=e.overlay;i.indexOf("CLOSE")>-1?this.execute({close:!0,uid:i.indexOf(":")>-1?i.split(":")[1]:e.uid}):this.execute({action:i,url:s.url,params:s.params,css:e.css,uid:e.uid,title:e.title})}}class R{constructor(t){this.handle=t.handle,this.spinner=t.spinner,this.afr=null}bind(t){this.afr||b(this,'\n              <iframe t-elem="afr" id="ajaxformresponse"\n                      name="ajaxformresponse" src="about:blank"\n                      style="width:0px;height:0px;display:none">\n              </iframe>\n            ',e("body")),e(t).append('<input type="hidden" name="ajax" value="1" />').attr("target","ajaxformresponse").off().on("submit",function(t){this.spinner.show()}.bind(this))}render(t){this.spinner.hide(),t.error||(this.afr.remove(),this.afr=null),t.payload&&this.handle.update(t),this.handle.next(t.next)}}class W extends D{bind(t,s){e(t).off(s).on(s,this.dispatch_handle.bind(this))}dispatch_handle(t){t.preventDefault(),t.stopPropagation();let s=e(t.currentTarget),i={elem:s,event:t};s.attr("ajax:confirm")?N({message:s.attr("ajax:confirm"),on_confirm:function(t){this.dispatch(i)}.bind(this)}):this.dispatch(i)}dispatch(t){let e=t.elem,s=t.event;e.attr("ajax:action")&&this.trigger("on_action",{target:this.action_target(e,s),action:e.attr("ajax:action")}),e.attr("ajax:event")&&this.trigger("on_event",{target:e.attr("ajax:target"),event:e.attr("ajax:event")}),e.attr("ajax:overlay")&&this.trigger("on_overlay",{target:this.action_target(e,s),overlay:e.attr("ajax:overlay"),css:e.attr("ajax:overlay-css"),uid:e.attr("ajax:overlay-uid"),title:e.attr("ajax:overlay-title")}),e.attr("ajax:path")&&this.trigger("on_path",{elem:e,event:s})}}class U extends D{constructor(t){super(),this.ajax=t,this.spinner=t.spinner}update(t){let s,i=t.payload,a=t.selector,n=t.mode;"replace"===n?(e(a).replaceWith(i),s=e(a),s.length?this.ajax.bind(s.parent()):this.ajax.bind(e(document))):"inner"===n&&(s=e(a),s.html(i),this.ajax.bind(s))}next(t){if(t&&t.length){this.spinner.hide();for(let s of t){let t=s.type;if(delete s.type,"path"===t)this.ajax.path(s);else if("action"===t){let t=this.parse_target(s.target);s.url=t.url,s.params=t.params,this.ajax.action(s)}else if("event"===t)this.ajax.trigger(s);else if("overlay"===t){let t=this.parse_target(s.target);s.url=t.url,s.params=t.params,this.ajax.overlay(s)}else"message"===t&&(s.flavor?P({message:s.payload,flavor:s.flavor}):e(s.selector).html(s.payload))}}}}class z extends x{constructor(t){super(),this.dispatcher=t.dispatcher,this.form=t.form}parse(t){let e=this.node_attrs(t);if(e["ajax:bind"]&&(e["ajax:action"]||e["ajax:event"]||e["ajax:overlay"])){let s=e["ajax:bind"];this.dispatcher.bind(t,s)}e["ajax:form"]&&this.form.bind(t),"form"===t.tagName.toLowerCase()&&t.className.split(" ").includes("ajax")&&this.form.bind(t)}}class B extends D{constructor(t=window){super(),this.win=t,this.binders={};let e=this.spinner=new T,s=this.dispatcher=new W,i=this._request=new M({spinner:e,win:t,default_403:"/login"});this._path=new G({dispatcher:s,win:t}),this._event=new H({dispatcher:s});let a=new U(this),n={dispatcher:s,win:t,handle:a,spinner:e,request:i};this._action=new V(n),this._overlay=new I(n),this._form=new R({handle:a,spinner:e})}register(t,e){let s="binder_"+i();for(;void 0!==this.binders[s];)s="binder_"+i();this.binders[s]=t,e&&t()}bind(t){let e=new z({dispatcher:this.dispatcher,form:this._form});t.each((function(){e.walk(this)}));for(let e in this.binders)try{this.binders[e](t)}catch(t){console.log(t)}return t}request(t){this._request.execute(t)}path(t){this._path.execute(t)}action(t){this._action.execute(t)}trigger(t){arguments.length>1&&(s("Calling Ajax.event with positional arguments","opts","1.0"),t={name:arguments[0],selector:arguments[1],target:arguments[2],data:arguments[3]}),this._event.execute(t)}overlay(t){return this._overlay.execute(t)}form(t){this._form.render(t)}parseurl(t){return s("ts.ajax.parseurl","ts.parse_url","1.0"),r(t)}parsequery(t,e){return s("ts.ajax.parsequery","ts.parse_query","1.0"),o(t,e)}parsepath(t,e){return s("ts.ajax.parsepath","ts.parse_path","1.0"),h(t,e)}parsetarget(t){return s("ts.ajax.parsetarget","ts.ajax.parse_target","1.0"),this.parse_target(t)}message(t,e=""){s("ts.ajax.message","ts.show_message","1.0"),P({message:t,flavor:e})}info(t){s("ts.ajax.info","ts.show_info","1.0"),E(t)}warning(t){s("ts.ajax.warning","ts.show_warning","1.0"),S(t)}error(t){s("ts.ajax.error","ts.show_error","1.0"),C(t)}dialog(t,e){s("ts.ajax.dialog","ts.show_dialog","1.0"),N({message:t.message,on_confirm:function(){e(t)}})}}let K=new B;e.fn.tsajax=function(){return K.bind(this),this};class X extends k{constructor(){super(),this._down_handle=null,this._down_scope=null,this._move_scope=null}reset_state(){this._move_handle=null,this._up_handle=null,this._prev_pos=null,this._motion=null}set_scope(t,s){if(this._up_handle)throw"Attempt to set motion scope while handling";this.reset_state(),this._down_handle&&e(this._down_scope).off("mousedown",this._down_handle),this._down_handle=this._mousedown.bind(this),this._down_scope=t,e(t).on("mousedown",this._down_handle),this._move_scope=s||null}_mousedown(t){t.stopPropagation(),this._motion=!1,this._prev_pos={x:t.pageX,y:t.pageY},this._move_scope&&(this._move_handle=this._mousemove.bind(this),e(this._move_scope).on("mousemove",this._move_handle)),this._up_handle=this._mouseup.bind(this),e(document).on("mouseup",this._up_handle),this.trigger("down",t)}_mousemove(t){t.stopPropagation(),this._motion=!0,t.motion=this._motion,t.prev_pos=this._prev_pos,this.trigger("move",t),this._prev_pos.x=t.pageX,this._prev_pos.y=t.pageY}_mouseup(t){t.stopPropagation(),this._move_scope&&e(this._move_scope).off("mousemove",this._move_handle),e(document).off("mouseup",this._up_handle),t.motion=this._motion,this.trigger("up",t),this.reset_state()}}class Y extends X{constructor(t){super(),new p(this,"parent"),this.parent=t||null}acquire(t){let e=this.parent;for(;e&&e&&!(e instanceof t);)e=e.parent;return e}}class F extends Y{constructor(t,e){super(t),this.elem=e,new m(this,"x",{tgt:"left"}),new m(this,"y",{tgt:"top"}),new m(this,"width"),new m(this,"height")}get offset(){return e(this.elem).offset()}}return e((function(){K.spinner.hide(),e(document).tsajax()})),t.Ajax=B,t.AjaxAction=V,t.AjaxDispatcher=W,t.AjaxEvent=H,t.AjaxForm=R,t.AjaxHandle=U,t.AjaxOperation=L,t.AjaxOverlay=I,t.AjaxParser=z,t.AjaxPath=G,t.AjaxRequest=M,t.AjaxSpinner=T,t.AjaxUtil=D,t.AttrProperty=class extends _{set(t){this.ctx.attr(this.tgt,t),super.set(t)}},t.BoundProperty=_,t.ButtonProperty=f,t.CSSProperty=m,t.DataProperty=class extends _{constructor(t,e,s){s?s.ctx=void 0!==s.ctx?s.ctx:t.data:s={ctx:t.data},s.ctxa="data",super(t,e,s)}set(t){this.ctx[this.tgt]=t,super.set(t)}},t.Dialog=O,t.Events=k,t.HTMLParser=y,t.HTMLWidget=F,t.InputProperty=g,t.KeyState=class extends k{constructor(t){super(),this.filter_keyevent=t,this._keys=[],this._add_key("ctrl",17),this._add_key("shift",16),this._add_key("alt",18),this._add_key("enter",13),this._add_key("esc",27),this._add_key("delete",46),this.bind()}unload(){e(window).off("keydown",this._keydown_handle),e(window).off("keyup",this._keyup_handle)}bind(){this._keydown_handle=this._keydown.bind(this),this._keyup_handle=this._keyup.bind(this),e(window).on("keydown",this._keydown_handle),e(window).on("keyup",this._keyup_handle)}_add_key(t,e){this._keys.push(t),this[`_${t}`]=!1,Object.defineProperty(this,t,{get:function(){return this[`_${t}`]},set:function(s){let i=this[`_${t}`];"keydown"==s.type?i||s.keyCode!=e||(this[`_${t}`]=!0):i&&s.keyCode==e&&(this[`_${t}`]=!1)}})}_set_keys(t){for(let e of this._keys)this[e]=t}_filter_event(t){return this.filter_keyevent&&this.filter_keyevent(t)}_keydown(t){this._set_keys(t),this._filter_event(t)||this.trigger("keydown",t)}_keyup(t){this._set_keys(t),this._filter_event(t)||this.trigger("keyup",t)}},t.Message=q,t.Motion=X,t.Overlay=A,t.Parser=x,t.Property=p,t.SVGContext=class extends F{constructor(t,e){let s=t.elem.get(0);super(t,d("svg",{class:e},s)),this.svg_ns=l,this.xyz={x:0,y:0,z:1}}svg_attrs(t,e){c(t,e)}svg_elem(t,e,s){return d(t,e,s)}},t.SVGParser=j,t.SVGProperty=class extends _{set(t){let e={};e[this._name]=t,c(this.ctx,e),super.set(t)}},t.TemplateParser=v,t.TextProperty=class extends _{set(t){this.ctx.text(t),super.set(t)}},t.Widget=Y,t.ajax=K,t.compile_svg=function(t,e,s){let i=u(e,s),a=new j(t);return i.forEach((function(t,e){a.walk(t)})),i},t.compile_template=b,t.create_cookie=function(t,e,s){var i,a;s?((i=new Date).setTime(i.getTime()+24*s*60*60*1e3),a="; expires="+i.toGMTString()):a="",document.cookie=t+"="+escape(e)+a+"; path=/;"},t.create_svg_elem=d,t.deprecate=s,t.extract_number=w,t.get_overlay=$,t.json_merge=function(t,e){let s={};for(let i of[t,e])for(let t in i)s[t]=i[t];return s},t.load_svg=function(t,s){e.get(t,function(t){let i=e(t).find("svg");i.removeAttr("xmlns:a"),s(i)}.bind(this),"xml")},t.parse_path=h,t.parse_query=o,t.parse_svg=u,t.parse_url=r,t.read_cookie=function(t){var e,s,i=t+"=",a=document.cookie.split(";");for(e=0;e<a.length;e+=1){for(s=a[e];" "===s.charAt(0);)s=s.substring(1,s.length);if(0===s.indexOf(i))return unescape(s.substring(i.length,s.length))}return null},t.set_default=a,t.set_svg_attrs=c,t.show_dialog=N,t.show_error=C,t.show_info=E,t.show_message=P,t.show_warning=S,t.svg_ns=l,t.uuid4=i,Object.defineProperty(t,"__esModule",{value:!0}),window.treibstoff=t,window.bdajax=t.ajax,e.fn.bdajax=e.fn.tsajax,t}({},jQuery);
//# sourceMappingURL=treibstoff.bundle.min.js.map
